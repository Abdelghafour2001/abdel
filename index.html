<!doctype html>
<html>
<head>
  <title>Abdel's Covid-19 Tracker</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
  * {
    box-sizing:border-box;
 }
body, aside, #tabTitle {
    background-color:rgb(0, 98, 209);
}
h2, body {
    margin:0;
}
h1, h2 {
    text-align:center;
}
h2 {
    font-size:1.7em;
    height:40px;
    padding-top:5px;
    box-shadow:0 1px 8px #422;
    position:sticky;
    top:0;
}
input {
    width:99%;
    border-radius:20px;
    border:2px solid #d43;
    padding-left:10px;
    padding-right: 30px;
}
input:focus {
    outline:0;
    border:2px solid #88f;
}
input, button {
    height:35px;
    font-weight:bolder;
}
header {
    background-image: url("https://phil.cdc.gov//PHIL_Images/23311/23311_lores.jpg");
    background-position:center;
    background-size:contain;
    height: 22vh;
    width:100%;
    margin-top:-20px;
}
h1 {
    line-height:100px;
    font-family:fantasy;
    color:dodgerblue;
    text-shadow:-1px -1px 1px #a99, 1px 1px 1px #a99;
}
#main {
    min-height: 100vh;
    padding:25px 0 17vh 0;
    color:#334;
    background-color:#fff;
}
section>div {
    display:none;
    height:100%;
}
#advice, #news {
    padding:8px;
    background:linear-gradient(to right, #aaa, #faa);
    margin:-22px 0 -17px 0;
}

table {
    width:100%;
    margin-bottom:20px;
    animation:disp 1s linear;
}
@keyframes disp {
    from {
        opacity:0;
    }
    to {
        opacity:1;
    }
}
 td {
    width:50%;
    padding:10px;
    border-bottom:2px solid #d43;
    font-weight:bolder;
    font-size:1.1em;
}
table caption {
    color:#523;
    font-weight:bold;
    font-size:1.2em;
    padding:8px;
    border-bottom:2px solid #d43;
}
td:nth-child(even) {
    text-align:right;
}
div.focused {
    display:block;
}
#searchBar {
    position:relative;
    overflow:hidden;
    height:0;
    transition:height 1s;
}
#tabTitle>.fa-bars {
    display:inline-block;
    position:absolute;
    right:10px;
}
input+.fa-search {
    display:inline-block;
    position:absolute;
    right:15px;
    top:7px;
    height:35px;
    color:#d43;
    font-size:1.2em;
}
aside {
    height: 13vh;
    width:100%;
    box-shadow:0 -1px 8px #422;
    position:fixed;
    bottom:0;
}
.navB, #tabTitle {
    color:#fff;
    z-index:1;
}
#tabTitle>div {
    width:150px;
    height:120px;
    font-size:0.6em;
    font-weight:lighter;
    color:#000;
    text-align:left;
    background-color:#fff;
    box-shadow:-1px 1px 8px #422;
    position:absolute;
    right:5px;
    top:5px;
    display:none;
    animation:display 0.5s linear;
    overflow:hidden;
}
@keyframes display {
    from {
        right:-140px;
    }
    to {
        right:5px;
    }
}
#tabTitle>div>div {
    padding:10px;
}
#tabTitle>div>div:hover {
    background-color:#9ee;
}
.navB {
    display:inline-block;
    width:25%;
    height:100%;
    grid-area:auto;
    text-align:center;
    margin:-2px;
    padding-top: 3.5vh;
    font-size:1.5em;
    font-weight:bolder;
    font-family: halvatica;
}

.active {
    opacity:0.5;
}
.spin {
    width:60px;
    height:60px;
    border-width:8px;
    border-style:solid;
    border-color:#fff;
    border-bottom-color:#000;
    border-top-color:#000;
    border-radius:50%;
    margin:auto;
    margin-top:30px;
    animation:spin 1s linear infinite;
}
@keyframes spin {
    from {
        transform:rotate(0deg);
    }
    to {
        transform:rotate(360deg);
    }
}
#loading {
    width:100%;
    height:100%;
    display:block;
    position:fixed;
}
#retry {
    text-align:center;
    padding-top:80px;
    font-weight:bolder;
}
button {
    display:block;
    background-color:#d43;
    border:0;
    font-weight: bolder;
    color:#fff;
    margin:auto;
    margin-top:10px;
    width:80px;
}
</style>
</head>
<body>
  <header>
    <h1>Covid19 Tracker</h1>
</header>
<h2 id='tabTitle'></h2>
<section id="main">
    <div id="top5">
    </div>
    <div id="home">
        <div id='searchBar'>
            <input type='search' id='countrySearch' placeholder='Search Country'>
            <span onclick="searchCountry()" class='fa fa-search'></span>
        </div>
        <table id="homeSummary"> 
        </table>
    </div>
    <div id="news">
       <!--<iframe id="newsFrame" src="" height="100%" width="100%"></iframe>-->
      <h3>WHO, Gavi and UNICEF warn that disruption to routine vaccination leaves at least 80 million children at risk</h3>  

<div>22 May 2020 </div> 

<p> COVID 19 is disrupting life-saving immunization services around the world, putting millions of children – in rich and poor countries alike – at risk of diseases like diphtheria, measles and polio. </p> 


<p>Provision of routine immunization services is substantially hindered in at least 68 countries and is likely to affect approximately 80 million children under the age of 1 living in these countries. </p>


<p>Since March 2020, routine childhood immunization services have been disrupted on a global scale that may be unprecedented since the inception of expanded programs on immunization (EPI) in the 1970s.  </p>


<p>The reasons for disrupted services vary. Some parents are reluctant to leave home because of restrictions on movement, lack of information or because they fear infection with the COVID-19 virus. And many health workers are unavailable because of restrictions on travel, or redeployment to COVID response duties, as well as a lack of protective equipment. Transport delays of vaccines are also exacerbating the situation. </p>


<p>Despite the challenges, several countries are making special efforts to continue immunization. Uganda is ensuring that immunization services continue along with other essential health services, even funding transportation to ensure outreach activities. And in Lao PDR, despite a national lockdown imposed in March, routine immunization in fixed sites continued with physical distancing measures in place. </p>
    </div>
    
    
    <div id="advice">
    <br />
        <strong>Stay aware of the latest information on the COVID-19 outbreak, available on the WHO website and through your national and local public health authority. Most countries around the world have seen cases of COVID-19 and many are experiencing outbreaks. Authorities in China and some other countries have succeeded in slowing their outbreaks. However, the situation is unpredictable so check regularly for the latest news.</strong>

<h3>You can reduce your chances of being infected or spreading COVID-19 by taking some simple precautions:</h3>
<ul>
<li>Regularly and thoroughly clean your hands with an alcohol-based hand rub or wash them with soap and water. Why? Washing your hands with soap and water or using alcohol-based hand rub kills viruses that may be on your hands.</li>

<li>Maintain at least 1 metre (3 feet) distance between yourself and others. Why? When someone coughs, sneezes, or speaks they spray small liquid droplets from their nose or mouth which may contain virus. If you are too close, you can breathe in the droplets, including the COVID-19 virus if the person has the disease.</li>

<li>Avoid going to crowded places. Why? Where people come together in crowds, you are more likely to come into close contact with someone that has COIVD-19 and it is more difficult to maintain physical distance of 1 metre (3 feet).</li>

<li>Avoid touching eyes, nose and mouth. Why? Hands touch many surfaces and can pick up viruses. Once contaminated, hands can transfer the virus to your eyes, nose or mouth. From there, the virus can enter your body and infect you.</li>

<li>Make sure you, and the people around you, follow good respiratory hygiene. This means covering your mouth and nose with your bent elbow or tissue when you cough or sneeze. Then dispose of the used tissue immediately and wash your hands. Why? Droplets spread virus. By following good respiratory hygiene, you protect the people around you from viruses such as cold, flu and COVID-19.</li>

<li>Stay home and self-isolate even with minor symptoms such as cough, headache, mild fever, until you recover. Have someone bring you supplies. If you need to leave your house, wear a mask to avoid infecting others. Why? Avoiding contact with others will protect them from possible COVID-19 and other viruses.</li>

<li>If you have a fever, cough and difficulty breathing, seek medical attention, but call by telephone in advance if possible and follow the directions of your local health authority. Why? National and local authorities will have the most up to date information on the situation in your area. Calling in advance will allow your health care provider to quickly direct you to the right health facility. This will also protect you and help prevent spread of viruses and other infections.</li>

<li>Keep up to date on the latest information from trusted sources, such as WHO or your local and national health authorities. Why? Local and national authorities are best placed to advise on what people in your area should be doing to protect themselves.</li>
</ul>

<h3>Advice on the safe use of alcohol-based hand sanitizers</h3>

<ul>
<li>To protect yourself and others against COVID-19, clean your hands frequently and thoroughly. Use alcohol-based hand sanitizer or wash your hands with soap and water. If you use an alcohol-based hand sanitizer, make sure you use and store it carefully.</li>

<li>Keep alcohol-based hand sanitizers out of children’s reach. Teach them how to apply the sanitizer and monitor its use.</li>

<li>Apply a coin-sized amount on your hands. There is no need to use a large amount of the product.</li>

<li>Avoid touching your eyes, mouth and nose immediately after using an alcohol-based hand sanitizer, as it can cause irritation.</li>

<li>Hand sanitizers recommended to protect against COVID-19 are alcohol-based and therefore can be flammable. Do not use before handling fire or cooking.</li>

<li>Under no circumstance, drink or let children swallow an alcohol-based hand sanitizer. It can be poisonous. </li>
<br /><br />
<strong>Remember that washing your hands with soap and water is also effective against COVID-19.</strong>


    </div>
    <div id="loading"><div class='spin'></div></div>
    <div id="retry">Failed to retrieve data.<button onclick="initialize()">Try again</button></div>
</section>
<aside>
    <div class="navB top5" onclick="switchTab('top5')">
        <span class="fa fa-arrow-up">5 </span>
    </div>
    <div class="navB home" onclick="switchTab('home')">
        <span class="fa fa-home"></span>
    </div>
    <div class="navB news" onclick="switchTab('news')">
        <span class="fa fa-globe"></span>
    </div>
    <div class="navB advice" onclick="switchTab('advice')">
        <span class="fa fa-info"></span>
    </div>
</aside>
<!-- <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCOI2SHsx2yGrDAC9o-SDD3PvdZC_t9yYE&callBack=drawMap()">-->
</script>
<script>
    initialize();
    // Created by me


var countries = {}, summary = [], country = "", homeMenu, slug, global, loader;

function initialize() {
    document.getElementById("retry").style.display = "none";
    loader = document.getElementById("loading");
    loader.style.display = "block"; requestData("https://api.covid19api.com/summary", (result) => {
        if (result != 'Error') {
            summary = result.Countries;
            global = result.Global;
            summary.forEach((el) => {
              Object.assign(countries, {[el.Country.toUpperCase()]: el.Slug})
            })
            
            summary.sort((ele1, ele2) => {
                if (ele1.TotalConfirmed > ele2.TotalConfirmed) return -1;
                else if (ele1.TotalConfirmed < ele2.TotalConfirmed) return 1;
                else return 0;
            })

            switchTab('home');
            addHome();
            loader.style.display = "none";
            document.getElementById("retry").style.display = "none";
            addTop5();
        }
        
        else {
            document.getElementById("retry").style.display = "block";
            loader.style.display = "none";
        }
    });
}

function switchTab(tabName) {
    //Remove class active for current active button
    let actv = document.getElementsByClassName('active')[0];
    
    if (actv !== undefined) actv.classList.toggle('active');
    
    //add active class to selected tab button
    let btn = document.getElementsByClassName(tabName)[0];
    btn.classList += ' active';
    
    //set all tabs to display none
    let fc = document.getElementsByClassName ('focused')[0];
    if (fc != undefined) fc.classList.toggle('focused');
    
    let tab = document.getElementById(tabName);
    tab.classList.toggle('focused');
    
    changeTabContent();
}

function changeTabContent() {
    let tabId = document.getElementsByClassName('focused')[0].id;
    let tabTitle = document.getElementById('tabTitle');
    
    switch (tabId) {
        case "top5": tabTitle.innerHTML = "Highest Cases"; break;
        case "home": tabTitle.innerHTML = "Home <i class='fa fa-bars' onclick='viewMenu()'></i> <div id='homeMenu'><div onclick=display('searchBar')>Search Country</div><div onclick=display('map')>Select from Map</div><div onclick=display('global')>View Global</div></div>"; 
        homeMenu = document.getElementById("homeMenu")
         break;
        case "news": tabTitle.innerHTML  = "WHO News"; addNews(); break;
        case "advice": tabTitle.innerHTML = "WHO Advice"; addAdvice();
    }
}

function addTop5() {
   if (global != undefined) {
    let tab = document.getElementById("top5");
    let tables = "";
    for (let i = 0; i < 5; i++) {
        let data = summary[i];
        tables += `<table> <caption>${data.Country}</caption> ${getWorldTotalTable(data)}</table>`;
    }
    tab.innerHTML = tables;
    }
}
function addAdvice() {
    
}
function addNews() {
    
}
function addHome() {
     if (global != undefined) { 
             let table = `<caption>${country == ""? 'Global':country} Summary</caption>`;
             if (country != "") {
             
                 let localSum = summary.find((ele) => {return ele.Slug == slug;})
                 table = `<caption>${localSum.Country} Summary</caption>`;
                
                table += `<tr> <td> New Cases </td> <td> ${localSum.NewConfirmed} </td></tr>`;
                 table += `<tr> <td> Total Cases </td> <td> ${localSum.TotalConfirmed} </td></tr>`;
                 table += `<tr> <td> New Deaths </td> <td> ${localSum.NewDeaths} </td></tr>`;
                 table += `<tr> <td> Total Deaths </td> <td> ${localSum.TotalDeaths} </td></tr>`;
                 table += `<tr> <td> New Recovered </td> <td> ${localSum.NewRecovered} </td></tr>`;
                 table += `<tr> <td> Total Recovered </td> <td> ${localSum.TotalRecovered} </td></tr>`;
                 table += `<tr> <td> Total Active </td> <td> ${localSum.TotalConfirmed - localSum.TotalRecovered - localSum.TotalDeaths} </td></tr>`;
                 country = "";
             }
             
             else {
                 table += getWorldTotalTable(global);
             }
             
             document.getElementById('homeSummary').innerHTML = table;
       }      
}

function getWorldTotalTable(result) {
    let table = "";
    table += `<tr> <td> Total Cases </td> <td> ${result.TotalConfirmed} </td></tr>`;
    table += `<tr> <td> Total Deaths </td> <td> ${result.TotalDeaths} </td></tr>`;
    table += `<tr> <td> Total Recovered </td> <td> ${result.TotalRecovered} </td></tr>`;
    return table;
}

function requestData(url, callBack) {
    let xhttp = new XMLHttpRequest();
    xhttp.open('GET', url, true);
    xhttp.send();
    let call = 0;
    xhttp.onreadystatechange = () => {
        if (xhttp.readyState == 4 && xhttp.status == 200) {
            callBack(JSON.parse(xhttp.responseText));
            call++;
            xhttp.close;
        }
        
        else if (xhttp.status > 400) {
            callBack("Error");
            call++;
            xhttp.close;
        }
    }
    setTimeout(() => {
        if (call === 0) {
            callBack("Error");
            xhttp.close;
        }
    }, 10000);
}

function searchCountry() {
    let inp = document.getElementById('countrySearch');
    if (inp.value != "") {
        slug = countries[inp.value.toUpperCase()];
        if (slug != undefined) {
            country = inp.value; addHome();
            inp.value = null;
            inp.parentNode.style.height = "0";
        }
        else {
            let sugg = summary.find((ele) => { return ele.Country.toUpperCase().includes(inp.value.toUpperCase())});
        
            alert(`Country not found!\n\n${sugg? ("Did you mean " + sugg.Country + "?") : ""}`);
        }
    }
}
function viewMenu() {
    homeMenu.style.display = "block"
    let doc = document.getElementById("main");
    doc.onclick = (event) => {
        if (homeMenu.style.display == "block") {
            homeMenu.style.display = "none";
            doc.onclick = null;
        }
    }
}

function display(eleId) {
    let element = document.getElementById(eleId);
    homeMenu.style.display = "none"
    if (eleId == "searchBar") {
        element.style.height = "50px";
    }
    else if (eleId == "global") {
        addHome();
    }
    else {
        alert("Coming Soon!")
    }
}

</script>
		<script>
		
		</script>
	</body>
    
</html>
